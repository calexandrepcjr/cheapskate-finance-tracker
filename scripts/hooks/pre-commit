#!/bin/bash
#
# Git pre-commit hook for Cheapskate Finance Tracker
# Runs the test suite before allowing commits
#
# To install: ./scripts/setup-hooks.sh
#

set -e

echo "Running pre-commit tests..."

# Change to project root (in case hook is run from subdirectory)
cd "$(git rev-parse --show-toplevel)"

# Run tests
if ! go test ./... -v; then
    echo ""
    echo "=========================================="
    echo "COMMIT REJECTED: Tests failed!"
    echo "=========================================="
    echo ""
    echo "Please fix the failing tests before committing."
    echo "Run 'go test ./... -v' to see detailed output."
    exit 1
fi

echo ""
echo "All tests passed. Proceeding with commit..."
